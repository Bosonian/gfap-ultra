{"version":3,"file":"medical-core-Cya2lCqH.js","sources":["../../src/state/store.js","../../src/logic/validate.js","../../src/patterns/observer.js","../../src/performance/medical-performance-monitor.js"],"sourcesContent":["// State management for the Stroke Triage Assistant\r\n\r\nclass Store {\r\n  constructor() {\r\n    this.state = {\r\n      currentScreen: 'login',\r\n      results: null,\r\n      sessionId: null,\r\n      startTime: null,\r\n      formData: {},\r\n      validationErrors: {},\r\n      screenHistory: [],\r\n    };\r\n\r\n    this.listeners = new Set();\r\n    this.initialize();\r\n  }\r\n\r\n  initialize() {\r\n    this.state.sessionId = this.generateSessionId();\r\n    this.state.startTime = Date.now();\r\n  }\r\n\r\n  generateSessionId() {\r\n    const timestamp = Date.now();\r\n    try {\r\n      // Use cryptographically secure random values when available\r\n      if (typeof crypto !== 'undefined' && crypto.getRandomValues) {\r\n        const randomBytes = new Uint8Array(8);\r\n        crypto.getRandomValues(randomBytes);\r\n        const randomHex = Array.from(randomBytes)\r\n          .map((b) => b.toString(16).padStart(2, '0'))\r\n          .join('');\r\n        return `session_${timestamp}_${randomHex}`;\r\n      }\r\n    } catch {}\r\n    // Fallback to Math.random when Web Crypto is unavailable\r\n    const fallback = Math.random().toString(36).slice(2, 10);\r\n    return `session_${timestamp}_${fallback}`;\r\n  }\r\n\r\n  // Subscribe to state changes\r\n  subscribe(listener) {\r\n    this.listeners.add(listener);\r\n    return () => this.listeners.delete(listener);\r\n  }\r\n\r\n  // Notify all listeners of state changes\r\n  notify() {\r\n    console.log(`[Store] Notifying ${this.listeners.size} listeners of state change`);\r\n    this.listeners.forEach((listener) => listener(this.state));\r\n  }\r\n\r\n  // Get current state (read-only)\r\n  getState() {\r\n    return { ...this.state };\r\n  }\r\n\r\n  // Update state and notify listeners\r\n  setState(updates) {\r\n    this.state = { ...this.state, ...updates };\r\n    this.notify();\r\n  }\r\n\r\n  // Navigate to a new screen\r\n  navigate(screen) {\r\n    console.log(`[Store] navigate called: ${this.state.currentScreen} -> ${screen}`);\r\n    const history = [...this.state.screenHistory];\r\n\r\n    // Add current screen to history if not already there\r\n    if (this.state.currentScreen !== screen && !history.includes(this.state.currentScreen)) {\r\n      history.push(this.state.currentScreen);\r\n    }\r\n\r\n    const newState = {\r\n      currentScreen: screen,\r\n      screenHistory: history,\r\n    };\r\n\r\n    console.log('[Store] Setting new navigation state:', newState);\r\n    this.setState(newState);\r\n    console.log('[Store] State after navigation:', this.state.currentScreen);\r\n  }\r\n\r\n  // Navigate back to previous screen\r\n  goBack() {\r\n    const history = [...this.state.screenHistory];\r\n\r\n    if (history.length > 0) {\r\n      const previousScreen = history.pop();\r\n\r\n      this.setState({\r\n        currentScreen: previousScreen,\r\n        screenHistory: history,\r\n      });\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  // Navigate to home screen\r\n  goHome() {\r\n    this.setState({\r\n      currentScreen: 'triage1',\r\n      screenHistory: [],\r\n    });\r\n  }\r\n\r\n  // Store form data for a specific module\r\n  setFormData(module, data) {\r\n    const formData = { ...this.state.formData };\r\n    formData[module] = { ...data };\r\n    this.setState({ formData });\r\n  }\r\n\r\n  // Get form data for a specific module\r\n  getFormData(module) {\r\n    return this.state.formData[module] || {};\r\n  }\r\n\r\n  // Store validation errors\r\n  setValidationErrors(errors) {\r\n    this.setState({ validationErrors: errors });\r\n  }\r\n\r\n  // Clear validation errors\r\n  clearValidationErrors() {\r\n    this.setState({ validationErrors: {} });\r\n  }\r\n\r\n  // Store prediction results\r\n  setResults(results) {\r\n    this.setState({ results });\r\n  }\r\n\r\n  // Check if there's unsaved data\r\n  hasUnsavedData() {\r\n    return Object.keys(this.state.formData).length > 0 && !this.state.results;\r\n  }\r\n\r\n  // Reset to initial state\r\n  reset() {\r\n    const newState = {\r\n      currentScreen: 'triage1',\r\n      results: null,\r\n      sessionId: this.generateSessionId(),\r\n      startTime: Date.now(),\r\n      formData: {},\r\n      validationErrors: {},\r\n      screenHistory: [],\r\n    };\r\n    this.setState(newState);\r\n  }\r\n\r\n  // Log events for audit trail\r\n  logEvent(eventName, data = {}) {\r\n    const event = {\r\n      timestamp: Date.now(),\r\n      session: this.state.sessionId,\r\n      event: eventName,\r\n      data,\r\n    };\r\n\r\n    // In production, send to analytics service\r\n    // this.sendToAnalytics(event);\r\n  }\r\n\r\n  // Calculate session duration\r\n  getSessionDuration() {\r\n    return Date.now() - this.state.startTime;\r\n  }\r\n}\r\n\r\n// Create and export a singleton instance\r\nexport const store = new Store();\r\n\r\n// Export the Store class for testing purposes\r\nexport { Store };\r\n","import { VALIDATION_RULES } from '../config.js';\r\n\r\nexport function validateInput(name, value, rules, formData = null) {\r\n  const result = {\r\n    errors: [],\r\n    warnings: [],\r\n  };\r\n\r\n  if (rules.required && !value && value !== 0) {\r\n    result.errors.push('This field is required');\r\n  }\r\n\r\n  if (rules.min !== undefined && value !== '' && !isNaN(value) && parseFloat(value) < rules.min) {\r\n    result.errors.push(`Value must be at least ${rules.min}`);\r\n  }\r\n\r\n  if (rules.max !== undefined && value !== '' && !isNaN(value) && parseFloat(value) > rules.max) {\r\n    result.errors.push(`Value must be at most ${rules.max}`);\r\n  }\r\n\r\n  if (rules.pattern && !rules.pattern.test(value)) {\r\n    result.errors.push('Invalid format');\r\n  }\r\n\r\n  // Medical validation checks (warnings, not blocking errors)\r\n  if (rules.medicalCheck && value !== '' && !isNaN(value)) {\r\n    const medicalWarning = rules.medicalCheck(parseFloat(value), formData);\r\n    if (medicalWarning) {\r\n      result.warnings.push(medicalWarning);\r\n    }\r\n  }\r\n\r\n  // For backward compatibility, return just errors array if no warnings\r\n  if (result.warnings.length === 0) {\r\n    return result.errors;\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\nexport function validateForm(form) {\r\n  let isValid = true;\r\n  const validationErrors = {};\r\n\r\n  // Collect form data for medical checks\r\n  const formData = {};\r\n  Object.keys(VALIDATION_RULES).forEach((name) => {\r\n    const input = form.elements[name];\r\n    if (input) {\r\n      formData[name] = input.value;\r\n    }\r\n  });\r\n\r\n  const validationWarnings = {};\r\n\r\n  Object.entries(VALIDATION_RULES).forEach(([name, rules]) => {\r\n    const input = form.elements[name];\r\n    if (input) {\r\n      const validation = validateInput(name, input.value, rules, formData);\r\n\r\n      // Handle both old format (array) and new format (object)\r\n      if (Array.isArray(validation)) {\r\n        // Old format - just errors\r\n        if (validation.length > 0) {\r\n          validationErrors[name] = validation;\r\n          isValid = false;\r\n        }\r\n      } else {\r\n        // New format - errors and warnings\r\n        if (validation.errors.length > 0) {\r\n          validationErrors[name] = validation.errors;\r\n          isValid = false;\r\n        }\r\n        if (validation.warnings.length > 0) {\r\n          validationWarnings[name] = validation.warnings;\r\n        }\r\n      }\r\n    }\r\n  });\r\n\r\n  return { isValid, validationErrors, validationWarnings };\r\n}\r\n\r\nexport function showValidationErrors(container, validationErrors) {\r\n  Object.entries(validationErrors).forEach(([name, errors]) => {\r\n    const input = container.querySelector(`[name=\"${name}\"]`);\r\n    if (input) {\r\n      const group = input.closest('.input-group');\r\n      if (group) {\r\n        group.classList.add('error');\r\n        // Remove existing error messages\r\n        group.querySelectorAll('.error-message').forEach((el) => el.remove());\r\n        // Add new error message safely without innerHTML\r\n        const errorDiv = document.createElement('div');\r\n        errorDiv.className = 'error-message';\r\n\r\n        const iconSpan = document.createElement('span');\r\n        iconSpan.className = 'error-icon';\r\n        iconSpan.textContent = 'âš ï¸';\r\n\r\n        errorDiv.appendChild(iconSpan);\r\n        errorDiv.appendChild(document.createTextNode(` ${errors[0]}`));\r\n        group.appendChild(errorDiv);\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\nexport function showValidationWarnings(container, validationWarnings) {\r\n  Object.entries(validationWarnings).forEach(([name, warnings]) => {\r\n    const input = container.querySelector(`[name=\"${name}\"]`);\r\n    if (input) {\r\n      const group = input.closest('.input-group');\r\n      if (group) {\r\n        group.classList.add('warning');\r\n        // Remove existing warning messages\r\n        group.querySelectorAll('.warning-message').forEach((el) => el.remove());\r\n        // Add new warning message safely without innerHTML\r\n        const warningDiv = document.createElement('div');\r\n        warningDiv.className = 'warning-message';\r\n\r\n        const iconSpan = document.createElement('span');\r\n        iconSpan.className = 'warning-icon';\r\n        iconSpan.textContent = 'ðŸ’¡';\r\n\r\n        warningDiv.appendChild(iconSpan);\r\n        warningDiv.appendChild(document.createTextNode(` ${warnings[0]}`));\r\n        group.appendChild(warningDiv);\r\n      }\r\n    }\r\n  });\r\n}\r\n\r\nexport function clearValidationErrors(container) {\r\n  container.querySelectorAll('.input-group.error').forEach((group) => {\r\n    group.classList.remove('error');\r\n    group.querySelectorAll('.error-message').forEach((el) => el.remove());\r\n  });\r\n}\r\n\r\nexport function clearValidationWarnings(container) {\r\n  container.querySelectorAll('.input-group.warning').forEach((group) => {\r\n    group.classList.remove('warning');\r\n    group.querySelectorAll('.warning-message').forEach((el) => el.remove());\r\n  });\r\n}\r\n\r\nexport function clearAllValidation(container) {\r\n  clearValidationErrors(container);\r\n  clearValidationWarnings(container);\r\n}\r\n","/**\r\n * Observer Pattern Implementation for Medical Event Management\r\n * iGFAP Stroke Triage Assistant - Enterprise Architecture\r\n *\r\n * Provides secure, type-safe event handling for medical applications\r\n */\r\n\r\nexport class MedicalEventObserver {\r\n  constructor() {\r\n    this.observers = new Map();\r\n    this.eventHistory = [];\r\n    this.maxHistorySize = 1000;\r\n  }\r\n\r\n  /**\r\n   * Subscribe to medical events with validation\r\n   * @param {string} eventType - Medical event type\r\n   * @param {Function} callback - Observer callback function\r\n   * @param {Object} options - Observer options\r\n   * @returns {Function} Unsubscribe function\r\n   */\r\n  subscribe(eventType, callback, options = {}) {\r\n    if (typeof callback !== 'function') {\r\n      throw new Error('Observer callback must be a function');\r\n    }\r\n\r\n    if (!this.observers.has(eventType)) {\r\n      this.observers.set(eventType, new Set());\r\n    }\r\n\r\n    const observer = {\r\n      callback,\r\n      id: `obs_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n      priority: options.priority || 0,\r\n      once: options.once || false,\r\n      medicalContext: options.medicalContext || null,\r\n    };\r\n\r\n    this.observers.get(eventType).add(observer);\r\n\r\n    // Return unsubscribe function\r\n    return () => {\r\n      const eventObservers = this.observers.get(eventType);\r\n      if (eventObservers) {\r\n        eventObservers.delete(observer);\r\n        if (eventObservers.size === 0) {\r\n          this.observers.delete(eventType);\r\n        }\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Publish medical events with safety checks\r\n   * @param {string} eventType - Medical event type\r\n   * @param {Object} data - Event data\r\n   * @param {Object} metadata - Event metadata\r\n   */\r\n  publish(eventType, data = {}, metadata = {}) {\r\n    const eventObservers = this.observers.get(eventType);\r\n    if (!eventObservers || eventObservers.size === 0) {\r\n      return;\r\n    }\r\n\r\n    const event = {\r\n      type: eventType,\r\n      data: this.sanitizeEventData(data),\r\n      metadata: {\r\n        timestamp: new Date().toISOString(),\r\n        source: 'MedicalEventObserver',\r\n        ...metadata,\r\n      },\r\n      id: `evt_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\r\n    };\r\n\r\n    // Log event for medical audit trail\r\n    this.logEvent(event);\r\n\r\n    // Sort observers by priority (higher priority first)\r\n    const sortedObservers = Array.from(eventObservers).sort((a, b) => b.priority - a.priority);\r\n\r\n    // Notify observers with error handling\r\n    sortedObservers.forEach((observer) => {\r\n      try {\r\n        observer.callback(event);\r\n\r\n        // Remove one-time observers\r\n        if (observer.once) {\r\n          eventObservers.delete(observer);\r\n        }\r\n      } catch (error) {\r\n        // (`Medical observer error for event ${eventType}:`, error);\r\n        // Don't propagate observer errors to prevent cascade failures\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Sanitize event data to prevent sensitive information leakage\r\n   * @param {Object} data - Raw event data\r\n   * @returns {Object} Sanitized data\r\n   */\r\n  sanitizeEventData(data) {\r\n    const sensitiveFields = ['password', 'ssn', 'medical_record_number', 'patient_id'];\r\n    const sanitized = { ...data };\r\n\r\n    sensitiveFields.forEach((field) => {\r\n      if (sanitized[field]) {\r\n        sanitized[field] = '[REDACTED]';\r\n      }\r\n    });\r\n\r\n    return sanitized;\r\n  }\r\n\r\n  /**\r\n   * Log event for medical audit trail\r\n   * @param {Object} event - Event to log\r\n   */\r\n  logEvent(event) {\r\n    this.eventHistory.push({\r\n      ...event,\r\n      loggedAt: new Date().toISOString(),\r\n    });\r\n\r\n    // Maintain history size limit\r\n    if (this.eventHistory.length > this.maxHistorySize) {\r\n      this.eventHistory.shift();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get event history for audit purposes\r\n   * @param {string} eventType - Optional event type filter\r\n   * @returns {Array} Event history\r\n   */\r\n  getEventHistory(eventType = null) {\r\n    if (eventType) {\r\n      return this.eventHistory.filter((event) => event.type === eventType);\r\n    }\r\n    return [...this.eventHistory];\r\n  }\r\n\r\n  /**\r\n   * Clear all observers and history (for privacy compliance)\r\n   */\r\n  clearAll() {\r\n    this.observers.clear();\r\n    this.eventHistory = [];\r\n  }\r\n\r\n  /**\r\n   * Get observer statistics for monitoring\r\n   * @returns {Object} Observer statistics\r\n   */\r\n  getStats() {\r\n    const stats = {\r\n      totalEventTypes: this.observers.size,\r\n      totalObservers: 0,\r\n      eventHistory: this.eventHistory.length,\r\n      eventTypes: {},\r\n    };\r\n\r\n    this.observers.forEach((observers, eventType) => {\r\n      stats.totalObservers += observers.size;\r\n      stats.eventTypes[eventType] = observers.size;\r\n    });\r\n\r\n    return stats;\r\n  }\r\n}\r\n\r\n// Medical event types constants\r\nexport const MEDICAL_EVENTS = {\r\n  // Patient data events\r\n  PATIENT_DATA_UPDATED: 'patient_data_updated',\r\n  VALIDATION_ERROR: 'validation_error',\r\n  VALIDATION_SUCCESS: 'validation_success',\r\n\r\n  // Clinical workflow events\r\n  TRIAGE_COMPLETED: 'triage_completed',\r\n  ASSESSMENT_STARTED: 'assessment_started',\r\n  RESULTS_GENERATED: 'results_generated',\r\n\r\n  // System events\r\n  PERFORMANCE_WARNING: 'performance_warning',\r\n  SECURITY_EVENT: 'security_event',\r\n  AUDIT_EVENT: 'audit_event',\r\n\r\n  // User interaction events\r\n  FORM_SUBMITTED: 'form_submitted',\r\n  NAVIGATION_CHANGED: 'navigation_changed',\r\n  SESSION_TIMEOUT: 'session_timeout',\r\n};\r\n\r\n// Export singleton instance\r\nexport const medicalEventObserver = new MedicalEventObserver();\r\n","/**\r\n * Medical Performance Monitoring System\r\n * iGFAP Stroke Triage Assistant - Enterprise Performance Architecture\r\n *\r\n * Provides comprehensive performance monitoring for medical software compliance\r\n */\r\n\r\nimport { medicalEventObserver, MEDICAL_EVENTS } from '../patterns/observer.js';\r\n\r\n/**\r\n * Performance metric types for medical applications\r\n */\r\nexport const PerformanceMetricType = {\r\n  API_CALL: 'api_call',\r\n  VALIDATION: 'validation',\r\n  PREDICTION: 'prediction',\r\n  RENDER: 'render',\r\n  USER_INTERACTION: 'user_interaction',\r\n  MEMORY: 'memory',\r\n  NETWORK: 'network',\r\n  CACHE: 'cache',\r\n};\r\n\r\n/**\r\n * Performance thresholds for medical critical operations\r\n */\r\nexport const MedicalPerformanceThresholds = {\r\n  CRITICAL_API_RESPONSE: 3000, // 3 seconds max for critical medical APIs\r\n  VALIDATION_RESPONSE: 100, // 100ms max for form validation\r\n  PREDICTION_RESPONSE: 5000, // 5 seconds max for ML predictions\r\n  UI_RENDER: 16, // 16ms for 60fps smooth UI\r\n  USER_INTERACTION: 100, // 100ms max for immediate feedback\r\n  MEMORY_LEAK_THRESHOLD: 50 * 1024 * 1024, // 50MB memory increase\r\n};\r\n\r\n/**\r\n * Performance metric data structure\r\n */\r\nclass PerformanceMetric {\r\n  constructor(type, name, startTime = performance.now()) {\r\n    this.type = type;\r\n    this.name = name;\r\n    this.startTime = startTime;\r\n    this.endTime = null;\r\n    this.duration = null;\r\n    this.metadata = {};\r\n    this.id = `perf_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n    this.timestamp = new Date().toISOString();\r\n  }\r\n\r\n  /**\r\n   * Mark the end of the performance measurement\r\n   */\r\n  end() {\r\n    this.endTime = performance.now();\r\n    this.duration = this.endTime - this.startTime;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Add metadata to the metric\r\n   */\r\n  addMetadata(key, value) {\r\n    this.metadata[key] = value;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Check if metric exceeds threshold\r\n   */\r\n  exceedsThreshold() {\r\n    const threshold = MedicalPerformanceThresholds[this.getThresholdKey()];\r\n    return threshold && this.duration > threshold;\r\n  }\r\n\r\n  /**\r\n   * Get the appropriate threshold key for this metric\r\n   */\r\n  getThresholdKey() {\r\n    switch (this.type) {\r\n      case PerformanceMetricType.API_CALL:\r\n        return this.metadata.critical ? 'CRITICAL_API_RESPONSE' : 'PREDICTION_RESPONSE';\r\n      case PerformanceMetricType.VALIDATION:\r\n        return 'VALIDATION_RESPONSE';\r\n      case PerformanceMetricType.PREDICTION:\r\n        return 'PREDICTION_RESPONSE';\r\n      case PerformanceMetricType.RENDER:\r\n        return 'UI_RENDER';\r\n      case PerformanceMetricType.USER_INTERACTION:\r\n        return 'USER_INTERACTION';\r\n      default:\r\n        return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get performance grade based on thresholds\r\n   */\r\n  getPerformanceGrade() {\r\n    const threshold = MedicalPerformanceThresholds[this.getThresholdKey()];\r\n    if (!threshold) {\r\n      return 'N/A';\r\n    }\r\n\r\n    const ratio = this.duration / threshold;\r\n    if (ratio <= 0.5) {\r\n      return 'EXCELLENT';\r\n    }\r\n    if (ratio <= 0.75) {\r\n      return 'GOOD';\r\n    }\r\n    if (ratio <= 1.0) {\r\n      return 'ACCEPTABLE';\r\n    }\r\n    if (ratio <= 1.5) {\r\n      return 'WARNING';\r\n    }\r\n    return 'CRITICAL';\r\n  }\r\n}\r\n\r\n/**\r\n * Medical Performance Monitor for enterprise-grade monitoring\r\n */\r\nexport class MedicalPerformanceMonitor {\r\n  constructor() {\r\n    this.metrics = new Map();\r\n    this.activeMetrics = new Map();\r\n    this.memoryBaseline = null;\r\n    this.performanceObserver = null;\r\n    this.isMonitoring = false;\r\n    this.reportingInterval = null;\r\n    this.config = {\r\n      reportingIntervalMs: 30000, // Report every 30 seconds\r\n      maxMetricsRetention: 1000, // Keep last 1000 metrics\r\n      enableMemoryMonitoring: true,\r\n      enableNetworkMonitoring: true,\r\n      enableUserTimingAPI: true,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Start performance monitoring\r\n   */\r\n  start() {\r\n    if (this.isMonitoring) {\r\n      return;\r\n    }\r\n\r\n    this.isMonitoring = true;\r\n    this.memoryBaseline = this.getMemoryUsage();\r\n\r\n    // Initialize Performance Observer API if available\r\n    if (window.PerformanceObserver) {\r\n      this.initializePerformanceObserver();\r\n    }\r\n\r\n    // Start periodic reporting\r\n    this.reportingInterval = setInterval(() => {\r\n      this.generatePerformanceReport();\r\n    }, this.config.reportingIntervalMs);\r\n\r\n    medicalEventObserver.publish(MEDICAL_EVENTS.AUDIT_EVENT, {\r\n      action: 'performance_monitoring_started',\r\n      memoryBaseline: this.memoryBaseline,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Stop performance monitoring\r\n   */\r\n  stop() {\r\n    if (!this.isMonitoring) {\r\n      return;\r\n    }\r\n\r\n    this.isMonitoring = false;\r\n\r\n    if (this.performanceObserver) {\r\n      this.performanceObserver.disconnect();\r\n      this.performanceObserver = null;\r\n    }\r\n\r\n    if (this.reportingInterval) {\r\n      clearInterval(this.reportingInterval);\r\n      this.reportingInterval = null;\r\n    }\r\n\r\n    medicalEventObserver.publish(MEDICAL_EVENTS.AUDIT_EVENT, {\r\n      action: 'performance_monitoring_stopped',\r\n      totalMetrics: this.metrics.size,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Initialize Performance Observer for automatic metric collection\r\n   */\r\n  initializePerformanceObserver() {\r\n    try {\r\n      this.performanceObserver = new PerformanceObserver((list) => {\r\n        list.getEntries().forEach((entry) => {\r\n          this.recordPerformanceEntry(entry);\r\n        });\r\n      });\r\n\r\n      // Observe different types of performance entries\r\n      this.performanceObserver.observe({ entryTypes: ['measure', 'navigation', 'resource'] });\r\n    } catch (error) {\r\n      // ('Performance Observer not supported:', error.message);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Record performance entry from Performance Observer\r\n   */\r\n  recordPerformanceEntry(entry) {\r\n    let metricType = PerformanceMetricType.NETWORK;\r\n    let { name } = entry;\r\n\r\n    // Categorize based on entry type\r\n    switch (entry.entryType) {\r\n      case 'navigation':\r\n        metricType = PerformanceMetricType.RENDER;\r\n        name = 'page_load';\r\n        break;\r\n      case 'resource':\r\n        metricType = entry.name.includes('/api/') ? PerformanceMetricType.API_CALL : PerformanceMetricType.NETWORK;\r\n        break;\r\n      case 'measure':\r\n        metricType = this.categorizeUserMeasure(entry.name);\r\n        break;\r\n    }\r\n\r\n    const metric = new PerformanceMetric(metricType, name, entry.startTime);\r\n    metric.end();\r\n    metric.duration = entry.duration;\r\n    metric.addMetadata('entryType', entry.entryType);\r\n\r\n    this.storeMetric(metric);\r\n  }\r\n\r\n  /**\r\n   * Categorize user-defined measures\r\n   */\r\n  categorizeUserMeasure(name) {\r\n    if (name.includes('validation')) {\r\n      return PerformanceMetricType.VALIDATION;\r\n    }\r\n    if (name.includes('prediction')) {\r\n      return PerformanceMetricType.PREDICTION;\r\n    }\r\n    if (name.includes('render')) {\r\n      return PerformanceMetricType.RENDER;\r\n    }\r\n    if (name.includes('api')) {\r\n      return PerformanceMetricType.API_CALL;\r\n    }\r\n    return PerformanceMetricType.USER_INTERACTION;\r\n  }\r\n\r\n  /**\r\n   * Start measuring a performance metric\r\n   */\r\n  startMeasurement(type, name, metadata = {}) {\r\n    const metric = new PerformanceMetric(type, name);\r\n\r\n    // Add initial metadata\r\n    Object.entries(metadata).forEach(([key, value]) => {\r\n      metric.addMetadata(key, value);\r\n    });\r\n\r\n    this.activeMetrics.set(metric.id, metric);\r\n\r\n    // Also use User Timing API if enabled and available\r\n    if (this.config.enableUserTimingAPI && performance.mark) {\r\n      performance.mark(`${name}_start`);\r\n    }\r\n\r\n    return metric.id;\r\n  }\r\n\r\n  /**\r\n   * End measuring a performance metric\r\n   */\r\n  endMeasurement(metricId, additionalMetadata = {}) {\r\n    const metric = this.activeMetrics.get(metricId);\r\n    if (!metric) {\r\n      // (`Performance metric ${metricId} not found`);\r\n      return null;\r\n    }\r\n\r\n    metric.end();\r\n\r\n    // Add additional metadata\r\n    Object.entries(additionalMetadata).forEach(([key, value]) => {\r\n      metric.addMetadata(key, value);\r\n    });\r\n\r\n    // Use User Timing API if enabled\r\n    if (this.config.enableUserTimingAPI && performance.mark && performance.measure) {\r\n      try {\r\n        performance.mark(`${metric.name}_end`);\r\n        performance.measure(metric.name, `${metric.name}_start`, `${metric.name}_end`);\r\n      } catch (error) {\r\n        // ('Error creating performance measure:', error.message);\r\n      }\r\n    }\r\n\r\n    this.activeMetrics.delete(metricId);\r\n    this.storeMetric(metric);\r\n\r\n    // Check for performance violations\r\n    if (metric.exceedsThreshold()) {\r\n      this.handlePerformanceViolation(metric);\r\n    }\r\n\r\n    return metric;\r\n  }\r\n\r\n  /**\r\n   * Store metric with retention limits\r\n   */\r\n  storeMetric(metric) {\r\n    this.metrics.set(metric.id, metric);\r\n\r\n    // Implement retention policy\r\n    if (this.metrics.size > this.config.maxMetricsRetention) {\r\n      const oldestKey = this.metrics.keys().next().value;\r\n      this.metrics.delete(oldestKey);\r\n    }\r\n\r\n    // Publish metric event\r\n    medicalEventObserver.publish(MEDICAL_EVENTS.PERFORMANCE_METRIC, {\r\n      metric: {\r\n        id: metric.id,\r\n        type: metric.type,\r\n        name: metric.name,\r\n        duration: metric.duration,\r\n        grade: metric.getPerformanceGrade(),\r\n        exceedsThreshold: metric.exceedsThreshold(),\r\n      },\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Handle performance violations\r\n   */\r\n  handlePerformanceViolation(metric) {\r\n    const violation = {\r\n      metricId: metric.id,\r\n      type: metric.type,\r\n      name: metric.name,\r\n      duration: metric.duration,\r\n      threshold: MedicalPerformanceThresholds[metric.getThresholdKey()],\r\n      grade: metric.getPerformanceGrade(),\r\n      metadata: metric.metadata,\r\n    };\r\n\r\n    medicalEventObserver.publish(MEDICAL_EVENTS.PERFORMANCE_VIOLATION, violation);\r\n\r\n    // Log critical violations\r\n    if (metric.getPerformanceGrade() === 'CRITICAL') {\r\n      // ('CRITICAL PERFORMANCE VIOLATION:', violation);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get current memory usage\r\n   */\r\n  getMemoryUsage() {\r\n    if (performance.memory) {\r\n      return {\r\n        usedJSHeapSize: performance.memory.usedJSHeapSize,\r\n        totalJSHeapSize: performance.memory.totalJSHeapSize,\r\n        jsHeapSizeLimit: performance.memory.jsHeapSizeLimit,\r\n        timestamp: Date.now(),\r\n      };\r\n    }\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Check for memory leaks\r\n   */\r\n  checkMemoryLeaks() {\r\n    if (!this.config.enableMemoryMonitoring || !this.memoryBaseline) {\r\n      return null;\r\n    }\r\n\r\n    const currentMemory = this.getMemoryUsage();\r\n    if (!currentMemory) {\r\n      return null;\r\n    }\r\n\r\n    const memoryIncrease = currentMemory.usedJSHeapSize - this.memoryBaseline.usedJSHeapSize;\r\n    const isLeak = memoryIncrease > MedicalPerformanceThresholds.MEMORY_LEAK_THRESHOLD;\r\n\r\n    if (isLeak) {\r\n      medicalEventObserver.publish(MEDICAL_EVENTS.AUDIT_EVENT, {\r\n        action: 'memory_leak_detected',\r\n        memoryIncrease,\r\n        baseline: this.memoryBaseline.usedJSHeapSize,\r\n        current: currentMemory.usedJSHeapSize,\r\n      });\r\n    }\r\n\r\n    return {\r\n      memoryIncrease,\r\n      isLeak,\r\n      baseline: this.memoryBaseline,\r\n      current: currentMemory,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Generate comprehensive performance report\r\n   */\r\n  generatePerformanceReport() {\r\n    const metrics = Array.from(this.metrics.values());\r\n    const now = Date.now();\r\n    const lastHour = now - (60 * 60 * 1000);\r\n\r\n    // Filter metrics from last hour\r\n    const recentMetrics = metrics.filter((m) => new Date(m.timestamp).getTime() > lastHour);\r\n\r\n    // Group by type\r\n    const metricsByType = recentMetrics.reduce((acc, metric) => {\r\n      if (!acc[metric.type]) {\r\n        acc[metric.type] = [];\r\n      }\r\n      acc[metric.type].push(metric);\r\n      return acc;\r\n    }, {});\r\n\r\n    // Calculate statistics\r\n    const report = {\r\n      timestamp: new Date().toISOString(),\r\n      timeframe: 'last_hour',\r\n      totalMetrics: recentMetrics.length,\r\n      memoryStatus: this.checkMemoryLeaks(),\r\n      metricsByType: {},\r\n      violations: recentMetrics.filter((m) => m.exceedsThreshold()).length,\r\n      topSlowOperations: this.getTopSlowOperations(recentMetrics),\r\n    };\r\n\r\n    // Calculate statistics for each type\r\n    Object.entries(metricsByType).forEach(([type, typeMetrics]) => {\r\n      const durations = typeMetrics.map((m) => m.duration);\r\n      const grades = typeMetrics.map((m) => m.getPerformanceGrade());\r\n\r\n      report.metricsByType[type] = {\r\n        count: typeMetrics.length,\r\n        averageDuration: durations.reduce((a, b) => a + b, 0) / durations.length,\r\n        medianDuration: this.calculateMedian(durations),\r\n        minDuration: Math.min(...durations),\r\n        maxDuration: Math.max(...durations),\r\n        violations: typeMetrics.filter((m) => m.exceedsThreshold()).length,\r\n        gradeDistribution: this.calculateGradeDistribution(grades),\r\n      };\r\n    });\r\n\r\n    medicalEventObserver.publish(MEDICAL_EVENTS.PERFORMANCE_REPORT, report);\r\n\r\n    return report;\r\n  }\r\n\r\n  /**\r\n   * Calculate median value\r\n   */\r\n  calculateMedian(values) {\r\n    const sorted = [...values].sort((a, b) => a - b);\r\n    const mid = Math.floor(sorted.length / 2);\r\n    return sorted.length % 2 === 0\r\n      ? (sorted[mid - 1] + sorted[mid]) / 2\r\n      : sorted[mid];\r\n  }\r\n\r\n  /**\r\n   * Calculate grade distribution\r\n   */\r\n  calculateGradeDistribution(grades) {\r\n    return grades.reduce((acc, grade) => {\r\n      acc[grade] = (acc[grade] || 0) + 1;\r\n      return acc;\r\n    }, {});\r\n  }\r\n\r\n  /**\r\n   * Get top slow operations\r\n   */\r\n  getTopSlowOperations(metrics, limit = 10) {\r\n    return metrics\r\n      .sort((a, b) => b.duration - a.duration)\r\n      .slice(0, limit)\r\n      .map((m) => ({\r\n        name: m.name,\r\n        type: m.type,\r\n        duration: m.duration,\r\n        grade: m.getPerformanceGrade(),\r\n        timestamp: m.timestamp,\r\n      }));\r\n  }\r\n\r\n  /**\r\n   * Get performance statistics for specific type\r\n   */\r\n  getTypeStatistics(type, timeframeMs = 60 * 60 * 1000) {\r\n    const now = Date.now();\r\n    const cutoff = now - timeframeMs;\r\n\r\n    const typeMetrics = Array.from(this.metrics.values())\r\n      .filter((m) => m.type === type && new Date(m.timestamp).getTime() > cutoff);\r\n\r\n    if (typeMetrics.length === 0) {\r\n      return null;\r\n    }\r\n\r\n    const durations = typeMetrics.map((m) => m.duration);\r\n    return {\r\n      type,\r\n      count: typeMetrics.length,\r\n      averageDuration: durations.reduce((a, b) => a + b, 0) / durations.length,\r\n      medianDuration: this.calculateMedian(durations),\r\n      minDuration: Math.min(...durations),\r\n      maxDuration: Math.max(...durations),\r\n      violations: typeMetrics.filter((m) => m.exceedsThreshold()).length,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Clear all metrics (privacy compliance)\r\n   */\r\n  clearMetrics() {\r\n    this.metrics.clear();\r\n    this.activeMetrics.clear();\r\n\r\n    medicalEventObserver.publish(MEDICAL_EVENTS.AUDIT_EVENT, {\r\n      action: 'performance_metrics_cleared',\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get monitor configuration\r\n   */\r\n  getConfig() {\r\n    return { ...this.config };\r\n  }\r\n\r\n  /**\r\n   * Update monitor configuration\r\n   */\r\n  updateConfig(newConfig) {\r\n    this.config = { ...this.config, ...newConfig };\r\n\r\n    // Restart reporting interval if changed\r\n    if (newConfig.reportingIntervalMs && this.reportingInterval) {\r\n      clearInterval(this.reportingInterval);\r\n      this.reportingInterval = setInterval(() => {\r\n        this.generatePerformanceReport();\r\n      }, this.config.reportingIntervalMs);\r\n    }\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const medicalPerformanceMonitor = new MedicalPerformanceMonitor();\r\n"],"names":["Store","timestamp","randomBytes","randomHex","b","e","fallback","listener","updates","screen","history","newState","previousScreen","module","data","formData","errors","results","eventName","store","validateInput","name","value","rules","result","medicalWarning","validateForm","form","isValid","validationErrors","VALIDATION_RULES","input","validationWarnings","validation","showValidationErrors","container","group","el","errorDiv","iconSpan","MedicalEventObserver","eventType","callback","options","observer","eventObservers","metadata","event","a","error","sensitiveFields","sanitized","field","stats","observers","MEDICAL_EVENTS","medicalEventObserver","PerformanceMetricType","MedicalPerformanceThresholds","PerformanceMetric","type","startTime","key","threshold","ratio","MedicalPerformanceMonitor","list","entry","metricType","metric","metricId","additionalMetadata","oldestKey","violation","currentMemory","memoryIncrease","isLeak","metrics","lastHour","recentMetrics","m","metricsByType","acc","report","typeMetrics","durations","grades","values","sorted","mid","grade","limit","timeframeMs","cutoff","newConfig","medicalPerformanceMonitor"],"mappings":"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"}